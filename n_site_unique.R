# 'data.frame':	336 obs. of  9 variables:
# $ block  : Factor w/ 3 levels "ecoliFASTHMMTEST",..: 1 1 1 1 1 1 1 1 1 1 ...
# $ codon  : Factor w/ 1 level "selac": 1 1 1 1 1 1 1 1 1 1 ...
# $ nuc    : Factor w/ 2 levels "GTR","UNREST": 1 1 1 1 1 1 1 1 2 2 ...
# $ gamma  : Factor w/ 4 levels "lognormal","median",..: 3 3 3 3 3 3 3 3 3 3 ...
# $ version: Factor w/ 8 levels "2a6c393","5c98a1f",..: 2 2 2 2 2 2 2 2 2 2 ...
# $ mc     : int  5 1 5 1 5 1 5 1 1 1 ...
# $ seed   : int  2053 2054 2053 2054 2053 2054 2053 2054 3010 3013 ...
# $ ntick  : int  0 0 0 0 0 0 10 10 10 9 ...
# $ neval  : int  0 0 0 0 0 0 10 10 10 9 ...
# block,codon,nuc,gamma,version,mc,seed,ntick,neval


n.site.raw <- read.csv("notes_num_site_patterns.csv")
n.site.tmp = n.site.raw[with(n.site.raw,ntick>0),]; 
as.data.frame.table(with(n.site.tmp, tapply(ntick,list(block,seed), function(x) length(unique(x)))) )-> seed.tick.discord; 

tail(sort(seed.tick.discord$Freq))

n.site.tmp[with(n.site.tmp,neval != 4*ntick & gamma != "none"),]


n.site.tmp2=n.site.tmp[with(n.site.tmp,neval == 4*ntick | gamma == "none"),]
summary(with(n.site.tmp2,neval == 4*ntick | gamma == "none"))
write.csv(n.site.tmp2,file="site_pattern_counts.csv")

